{"ts":1377220607330,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"<?php \r\nclass AdminController extends AppController{\r\n  var $name = 'Admin';\r\n  var $uses = array('Admin');\r\n  \r\n  /**\r\n\t* @Date: October 17, 2011\r\n\t* @Method : admin_login\r\n\t* @Purpose: This function is to login admin.\r\n\t* @Param: none\r\n\t* @Return: none \r\n\t**/\r\n  function admin_login(){\r\n  \r\n\t\t$user_id = $this->Session->read('SESSION_ADMIN.id');\r\n\t\tif(!empty($user_id))\r\n\t\t\t$this->redirect('/admin/admin/dashboard');\r\n\t\t\t\r\n        if(!empty($this->request->data))\r\n    \t\t{\r\n    \t\t\t$this->Admin->set($this->request->data);\r\n    \t\t\t\t\r\n    \t\t\t\tif($this->Admin->validates())\r\n    \t\t\t\t{\t\t\t\t\r\n    \t\t\t\t$user_name = mysql_real_escape_string($this->request->data['Admin']['adminUserName']);\r\n    \t\t\t\t$user_password  = mysql_real_escape_string($this->request->data['Admin']['adminPassword']);\r\n    \t\t\t\t$userinfo = $this->Admin->find('first',array('conditions'=>array(\"Admin.username\"=>$user_name,\"Admin.password\"=>$user_password,'Admin.status'=>'Active')));\r\n    \t\t\t\r\n            if(!empty($userinfo)){\r\n            //pr($userinfo); die;\t\t\t\t\r\n    \t\t\t\t\t$this->Session->write('SESSION_ADMIN', $userinfo['Admin']);\r\n    \t\t\t    $this->redirect('/admin/admin/dashboard');\r\n    \t\t\t\t} else {\r\n    \t\t\t\t\t$this->Session->setFlash('<div class=\"fail\">'.__('USERNAME_PASSWORD_INCORRECT').'</div>');\r\n    \t\t\t\t}\r\n    \t\t\t} else  {\r\n    \t\t\t\t$this->set('error', true);\r\n    \t\t\t}\r\n      }\r\n  }//ef\r\n  \r\n  \r\n  /**\r\n\t* @Date: October 17, 2011\r\n\t* @Method : admin_dashboard\r\n\t* @Purpose: This function is for admin dashboard.\r\n\t* @Param: none\r\n\t* @Return: none \r\n\t**/\r\n\t\r\n\tfunction admin_dashboard(){\r\n  \r\n  }//ef\r\n  \r\n  \r\n  /**\r\n\t* @Date: October 17, 2011\r\n\t* @Method : admin_logout\r\n\t* @Purpose: This function is for admin logout.\r\n\t* @Param: none\r\n\t* @Return: none \r\n\t**/\r\n  \r\n  function admin_logout() {\r\n\t\tif(!empty($_SESSION)){\r\n\t\t\tforeach($_SESSION AS $session_index => $session_variable){\r\n\t\t\t\tif($session_index == 'SESSION_ADMIN'){\r\n\t\t\t\t\t$this->Session->delete($session_index);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t$this->Session->setFlash('<div class=\"success\">'.__('LOGOUT_SUCESSFULL').'</div>');\r\n    $this->redirect(\"/admin/\");\r\n\t}//ef\r\n  \r\n  \r\n  \r\n  /**\r\n\t* @Date: November 08, 2011\r\n\t* @Method : admin_fee\r\n\t* @Purpose: This function is for fee management.\r\n\t* @Param: none\r\n\t* @Return: none \r\n\t**/\r\n\tfunction admin_fee(){\r\n    App::import('Model','Fee');\r\n    $this->Fee = new Fee();\r\n    $fee = $this->Fee->find('first',array('fields'=>array('Fee.amount','Fee.id')));\r\n    $this->set('fee',$fee);\r\n    if(!empty($this->request->data)){\r\n      $this->Fee->set($this->request->data);\r\n      if($this->Fee->validates()){\r\n        $data           = array();\r\n        $data['id']     = $fee['Fee']['id'];\r\n        $data['amount'] = $this->request->data['Fee']['amount'];\r\n        $this->Fee->set($data);        \r\n        if($this->Fee->save($data))\r\n          $this->Session->setFlash('<div class=\"success\">'.__('AMOUNT_SAVED_SUCCESSFULLY').'</div>');\r\n          $this->redirect(array('controller'=>'admin','action'=>'fee','admin'=>true));\r\n      }else{\r\n        $this->set('errors',true);\r\n      }\r\n    }\r\n    \r\n  }//ef\r\n  \r\n}//ec\r\n\r\n?>"]],"start1":0,"start2":0,"length1":0,"length2":3104}]],"length":3104}
